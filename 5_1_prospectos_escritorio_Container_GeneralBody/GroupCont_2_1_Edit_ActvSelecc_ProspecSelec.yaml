- Button_edit_cancelUpd_ActSelec_verProspec:
    Control: Classic/Button@2.2.0
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =ColorFade(Self.Fill, -55%)
      BorderThickness: =0
      Color: =RGBA(255, 255, 255, 1)
      DisabledBorderColor: =RGBA(166, 166, 166, 1)
      Fill: =RGBA(_rBotonClaro,_gBotonClaro,_bBotonClaro,_aBotonClaro)
      Font: =Font.'Open Sans'
      Height: =55
      HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
      HoverColor: =RGBA(255, 255, 255, 1)
      HoverFill: =Self.Fill
      OnSelect: =Set(_crearAgenda,false)
      PressedBorderColor: =Self.Fill
      PressedColor: =Self.Fill
      PressedFill: =Self.Color
      RadiusBottomLeft: =30
      RadiusBottomRight: =30
      RadiusTopLeft: =30
      RadiusTopRight: =30
      Size: =16
      Text: ="CANCELAR"
      Visible: =_crearAgenda
      Width: =150
      X: =591
      Y: =774
- Button_edit_guardarUpd_ActSelec_verProspec:
    Control: Classic/Button@2.2.0
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =ColorFade(Self.Fill, -55%)
      BorderThickness: =0
      Color: =RGBA(255, 255, 255, 1)
      DisabledBorderColor: =RGBA(166, 166, 166, 1)
      Fill: =RGBA(104, 110, 72, 1)
      Font: =Font.'Open Sans'
      Height: =55
      HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
      HoverColor: =RGBA(255, 255, 255, 1)
      HoverFill: =Self.Fill
      OnSelect: |-
        =If(
            IsBlank(TextInp_edit_ActReali_verProspec.Text),
            Notify(
                "El campo de acciones debe estar diligenciado",
                NotificationType.Warning,
                6000
            ),
            IsBlank(Select_edit_fechaAct_verProspec.SelectedDate),
            Notify(
                "Debe seleccionar una fecha de seguimiento",
                NotificationType.Warning,
                6000
            ),
                    // Si pasa las validaciones, ejecutar el Patch correspondiente
            If(
                _nuevaAgenda,
                        // CREAR NUEVA ACTIVIDAD
                Patch(
                    tab_seguimiento_porCuenta,
                    Defaults(tab_seguimiento_porCuenta),
                    {
                        Anotaciones: TextInp_edit_ActReali_verProspec.Text,
                        Observaciones: TextInp_editView_obsvAct_verProspec.Text,
                        Cuenta: {
                            Id: _itemSeleccionadoProspect.ID,
                            Value: _itemSeleccionadoProspect.RazonSocial
                        },
                        FechaSeguimiento: Select_edit_fechaAct_verProspec.SelectedDate,
                        EstadoCuentaEnSeguimiento: {Value: _itemSeleccionadoProspect.EstadoCuenta.Value},
                        ComercialResponsable: {
                            '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims: "i:0#.f|membership|" & Lower(_infoUsuarioLoggeado.Email),
                            Department: "",
                            DisplayName: _infoUsuarioLoggeado.FullName,
                            Email: _infoUsuarioLoggeado.Email,
                            JobTitle: "",
                            Picture: ""
                        },
                        EstadoSeguimiento: {Value: "Pendiente"},
                        RequiereAccion: true
                    }
                );
                Notify(
                    "✓ Actividad creada exitosamente",
                    NotificationType.Success,
                    6000
                );
                Set(
                    _crearAgenda,
                    false
                );
                Reset(TextInp_edit_ActReali_verProspec);
                Reset(TextInp_editView_obsvAct_verProspec);
                Reset(Select_edit_fechaAct_verProspec),

                        // ACTUALIZAR ACTIVIDAD EXISTENTE
                Patch(
                    tab_seguimiento_porCuenta,
                    LookUp(
                        tab_seguimiento_porCuenta,
                        ID = _actividadSeleccionada.ID
                    ),
                    {
                        Anotaciones: TextInp_edit_ActReali_verProspec.Text,
                        Observaciones: TextInp_editView_obsvAct_verProspec.Text,
                        Cuenta: {
                            Id: _itemSeleccionadoProspect.ID,
                            Value: _itemSeleccionadoProspect.RazonSocial
                        },
                        FechaSeguimiento: Select_edit_fechaAct_verProspec.SelectedDate,
                        EstadoCuentaEnSeguimiento: {Value: _itemSeleccionadoProspect.EstadoCuenta.Value},
                        ComercialResponsable: {
                            '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                            Claims: "i:0#.f|membership|" & Lower(_infoUsuarioLoggeado.Email),
                            Department: "",
                            DisplayName: _infoUsuarioLoggeado.FullName,
                            Email: _infoUsuarioLoggeado.Email,
                            JobTitle: "",
                            Picture: ""
                        },
                        EstadoSeguimiento: {Value: "Pendiente"},
                        RequiereAccion: true
                    }
                );

                Set(
                    _actividadSeleccionada,
                    Blank()
                );
                Notify(
                    "✓ Actividad actualizada exitosamente",
                    NotificationType.Success,
                    6000
                );
                Set(
                    _crearAgenda,
                    false
                );
                Reset(TextInp_edit_ActReali_verProspec);
                Reset(TextInp_editView_obsvAct_verProspec);
                Reset(Select_edit_fechaAct_verProspec)
            )
        )
      PressedBorderColor: =Self.Fill
      PressedColor: =Self.Fill
      PressedFill: =Self.Color
      RadiusBottomLeft: =30
      RadiusBottomRight: =30
      RadiusTopLeft: =30
      RadiusTopRight: =30
      Size: =16
      Text: |-
        =If(
            IsBlank(_actividadSeleccionada),
            "GUARDAR",
            "ACTUALIZAR"
        )
      Visible: |-
        =If(
            IsBlank(_actividadSeleccionada),
            _crearAgenda,
            _crearAgenda && _actividadSeleccionada.EstadoSeguimiento.Value = "Pendiente" || _actividadSeleccionada.EstadoSeguimiento.Value = "Vencida"
        )
      Width: =150
      X: =772
      Y: =774
- Label_ObsAct_verProspec:
    Control: Label@2.5.1
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =RGBA(0, 18, 107, 1)
      Color: =RGBA(85, 69, 49, 1)
      Font: =Font.'Open Sans'
      FontWeight: =FontWeight.Semibold
      Height: =40
      Size: =20
      Text: ="Observaciones"
      Visible: =_crearAgenda
      Width: =350
      X: =71
      Y: =499
- Button_edit_Finalizar_ActSelec_verProspec:
    Control: Classic/Button@2.2.0
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =ColorFade(Self.Fill, -55%)
      BorderThickness: =0
      Color: =RGBA(255, 255, 255, 1)
      DisabledBorderColor: =RGBA(166, 166, 166, 1)
      Fill: =RGBA(104, 110, 72, 1)
      Font: =Font.'Open Sans'
      Height: =50
      HoverBorderColor: =ColorFade(Self.BorderColor, 20%)
      HoverColor: =RGBA(255, 255, 255, 1)
      HoverFill: =Self.Fill
      OnSelect: |-
        =If(
            IsBlank(TextInp_edit_ActReali_verProspec.Text),
            Notify(
                "El campo de acciones debe estar diligenciado",
                NotificationType.Warning,
                6000
            ),
            IsBlank(Select_edit_fechaAct_verProspec.SelectedDate),
            Notify(
                "Debe seleccionar una fecha de seguimiento",
                NotificationType.Warning,
                6000
            ),
            Patch(
                tab_seguimiento_porCuenta,
                LookUp(
                    tab_seguimiento_porCuenta,
                    ID = _actividadSeleccionada.ID
                ),
                {
                    Anotaciones: TextInp_edit_ActReali_verProspec.Text,
                    Observaciones: TextInp_editView_obsvAct_verProspec.Text,
                    Cuenta: {
                        Id: _itemSeleccionadoProspecto1.ID,
                        Value: _itemSeleccionadoProspecto1.RazonSocial
                    },
                    FechaSeguimiento: Select_edit_fechaAct_verProspec.SelectedDate,
                    EstadoCuentaEnSeguimiento: {Value: _itemSeleccionadoProspecto1.EstadoCuenta.Value},
                    ComercialResponsable: {
                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser",
                        Claims: "i:0#.f|membership|" & Lower(_infoUsuarioLoggeado.Email),
                        Department: "",
                        DisplayName: _infoUsuarioLoggeado.FullName,
                        Email: _infoUsuarioLoggeado.Email,
                        JobTitle: "",
                        Picture: ""
                    },
                    EstadoSeguimiento: {Value: "Completada"},
                    RequiereAccion: false
                }
            );
            Set(
                _crearAgenda,
                false
            );
            Reset(TextInp_edit_ActReali_verProspec),
            Reset(TextInp_editView_obsvAct_verProspec),
            Reset(Select_edit_fechaAct_verProspec),
            Set(
                _actividadSeleccionada,
                Blank()
            );
            Notify(
                "✓ Actividad finalizada exitosamente",
                NotificationType.Success,
                6000
            )
        )
      PressedBorderColor: =Self.Fill
      PressedColor: =Self.Fill
      PressedFill: =Self.Color
      RadiusBottomLeft: =30
      RadiusBottomRight: =30
      RadiusTopLeft: =30
      RadiusTopRight: =30
      Size: =16
      Text: ="FINALIZAR TAREA"
      Visible: =_crearAgenda && !_nuevaAgenda && _actividadSeleccionada.EstadoSeguimiento.Value = "Pendiente"
      Width: =246
      X: =1209
      Y: =185
- Label_ActReali_verProspec:
    Control: Label@2.5.1
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =RGBA(0, 18, 107, 1)
      Color: =RGBA(85, 69, 49, 1)
      Font: =Font.'Open Sans'
      FontWeight: =FontWeight.Semibold
      Height: =30
      Size: =20
      Text: ="Actividad a realizar"
      Visible: =_crearAgenda
      Width: =350
      X: =69
      Y: =220
- TextInp_editView_obsvAct_verProspec:
    Control: Classic/TextInput@2.3.2
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =
      BorderStyle: =BorderStyle.None
      Default: =_actividadSeleccionada.observaciones
      DelayOutput: =true
      DisplayMode: |-
        =If(
            IsBlank(_actividadSeleccionada),
            DisplayMode.Edit,
            _actividadSeleccionada.EstadoSeguimiento.Value = "Pendiente" || _actividadSeleccionada.EstadoSeguimiento.Value = "Vencida",
            DisplayMode.Edit,
            DisplayMode.View
        )
      Font: =Font.'Open Sans'
      Height: =175
      HoverBorderColor: =RGBA(0, 18, 107, 1)
      HoverFill: =RGBA(214, 221, 224, 1)
      Mode: =TextMode.MultiLine
      PaddingLeft: =5
      RadiusBottomLeft: =15
      RadiusBottomRight: =15
      RadiusTopLeft: =15
      RadiusTopRight: =15
      Size: =16
      Tooltip: =
      Visible: =_crearAgenda
      Width: =1384
      X: =69
      Y: =568
- TextInp_edit_ActReali_verProspec:
    Control: Classic/TextInput@2.3.2
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =
      BorderStyle: =BorderStyle.None
      Color: =RGBA(85, 69, 49, 1)
      Default: =_actividadSeleccionada.Anotaciones
      DelayOutput: =true
      DisplayMode: |-
        =If(
            IsBlank(_actividadSeleccionada),
            DisplayMode.Edit,
            _actividadSeleccionada.EstadoSeguimiento.Value = "Pendiente" || _actividadSeleccionada.EstadoSeguimiento.Value = "Vencida",
            DisplayMode.Edit,
            DisplayMode.View
        )
      Font: =Font.'Open Sans'
      Height: =85
      HoverBorderColor: =RGBA(0, 18, 107, 1)
      HoverFill: =RGBA(214, 221, 224, 1)
      Mode: =TextMode.MultiLine
      PaddingLeft: =5
      RadiusBottomLeft: =10
      RadiusBottomRight: =10
      RadiusTopLeft: =10
      RadiusTopRight: =10
      Size: =16
      Tooltip: =
      Visible: =_crearAgenda
      Width: =1384
      X: =69
      Y: =264
- Label_fechAct_verProspec:
    Control: Label@2.5.1
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =RGBA(0, 18, 107, 1)
      Color: =RGBA(85, 69, 49, 1)
      Font: =Font.'Open Sans'
      FontWeight: =FontWeight.Semibold
      Height: =30
      Size: =20
      Text: ="Fecha"
      Visible: =_crearAgenda
      Width: =350
      X: =69
      Y: =373
- TextInp_view_fechaAct_verProspec:
    Control: Classic/TextInput@2.3.2
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =
      BorderStyle: =BorderStyle.None
      Color: =RGBA(85, 69, 49, 1)
      Default: =
      DelayOutput: =true
      DisplayMode: =DisplayMode.View
      Font: =Font.'Open Sans'
      Height: =57
      HoverBorderColor: =RGBA(0, 18, 107, 1)
      HoverFill: =RGBA(214, 221, 224, 1)
      Mode: =TextMode.MultiLine
      PaddingLeft: =5
      RadiusBottomLeft: =10
      RadiusBottomRight: =10
      RadiusTopLeft: =10
      RadiusTopRight: =10
      Size: =16
      Tooltip: =
      Visible: =_crearAgenda
      Width: =1384
      X: =69
      Y: =424
- Select_edit_fechaAct_verProspec:
    Control: Classic/DatePicker@2.6.0
    Group: GroupCont_2_1_Edit_ActvSelecc_ProspecSelec
    Properties:
      BorderColor: =RGBA(0, 18, 107, 1)
      BorderStyle: =BorderStyle.None
      BorderThickness: =0
      Color: =RGBA(85, 69, 49, 1)
      DefaultDate: =_actividadSeleccionada.FechaSeguimiento
      DisplayMode: |-
        =If(
            IsBlank(_actividadSeleccionada),
            DisplayMode.Edit,
            _actividadSeleccionada.EstadoSeguimiento.Value = "Pendiente" || _actividadSeleccionada.EstadoSeguimiento.Value = "Vencida",
            DisplayMode.Edit,
            DisplayMode.View
        )
      Fill: =Color.Transparent
      Font: =Font.'Open Sans'
      Height: =44
      IconBackground: =Color.Transparent
      IconFill: =RGBA(85, 69, 49, 1)
      OnChange: |-
        =// Solo validar si hay una fecha seleccionada (no es Blank)
        If(
            !IsBlank(Self.SelectedDate),
            If(
                _primeraAccion = 1 || _nuevaAgenda || (!IsBlank(_actividadSeleccionada) && _actividadSeleccionada.EstadoSeguimiento.Value = "Pendiente"),
                // Solo validar fechas para nueva agenda o primera acción
                If(
                    Select_edit_fechaAct_verProspec.SelectedDate < Today(),
                    Notify(
                        "⚠ Fecha no válida: Solo se permiten fechas desde hoy (" & Text(
                            Today(),
                            "dd/mm/yyyy"
                        ) & ") en adelante.",
                        NotificationType.Error,
                        6000
                    ) && Reset(Self) && Set(
                        _fechaActivaSseleccionada,
                        Blank()
                    ),
                    Set(
                        _fechaActivaSseleccionada,
                        Self.SelectedDate
                    )
                ),
            // Si no es primera acción ni nueva agenda, asignar directamente
                Set(
                    _fechaActivaSseleccionada,
                    Self.SelectedDate
                )
            ),
        // Si la fecha está en blanco (reset), limpiar la variable
            Set(
                _fechaActivaSseleccionada,
                Blank()
            )
        )
      Size: =16
      Visible: =_crearAgenda
      Width: =1346
      X: =88
      Y: =430
